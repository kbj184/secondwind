# /etc/nginx/sites-available/default 또는 llrun.conf 수정 예시

server {
    listen 80;
    server_name api.llrun.shop; # 백엔드 도메인

    # 점검 페이지 파일 루트 (EC2에 maintenance.html 파일을 이 위치에 업로드해야 함)
    root /usr/share/nginx/html;

    # 1. 특정 IP (관리자)는 접근 허용 (선택 사항)
    # allow 111.222.333.444; 
    # deny all;

    # 2. 점검 모드 활성화 (503 에러 반환)
    # 점검 시 아래 location 블록 주석을 해제하세요
    
    # location / {
    #     return 503;
    # }

    # 3. 503 에러 발생 시 maintenance.html 표시
    error_page 503 @maintenance;

    location @maintenance {
        rewrite ^(.*)$ /maintenance.html break;
    }
    
    # API 프록시 설정 (기존 설정)
    location /api {
        # 점검 시 아래 한 줄 추가하여 API도 503 반환
        return 503; 
        
        proxy_pass http://localhost:8080;
        # ... 기타 프록시 설정 ...
    }
}
